/* The standalone browser bundle of MegaNzApi 0.2.0, License MIT (https://github.com/alttiri/meganz-api/blob/master/LICENSE).
 * Dependencies:  CryptoES ^1.2.6, License MIT (https://github.com/entronad/crypto-es/blob/master/LICENSE).*/
import e from"megajs2/src/util.js";import t from"megajs2/src/mega-util.js";import{Semaphore as s}from"megajs2/src/synchronization.js";import r from"megajs2/src/grouped-tasks.js";class i{static create(...e){return new this(...e)}mixIn(e){return Object.assign(this,e)}clone(){const e=new this.constructor;return Object.assign(e,this),e}}class n extends i{constructor(e=[],t=4*e.length){super();let s=e;if(s instanceof ArrayBuffer&&(s=new Uint8Array(s)),(s instanceof Int8Array||s instanceof Uint8ClampedArray||s instanceof Int16Array||s instanceof Uint16Array||s instanceof Int32Array||s instanceof Uint32Array||s instanceof Float32Array||s instanceof Float64Array)&&(s=new Uint8Array(s.buffer,s.byteOffset,s.byteLength)),s instanceof Uint8Array){const e=s.byteLength,t=[];for(let r=0;r<e;r+=1)t[r>>>2]|=s[r]<<24-r%4*8;this.words=t,this.sigBytes=e}else this.words=e,this.sigBytes=t}static random(e){const t=[],s=e=>{let t=e,s=987654321;const r=4294967295;return()=>{s=36969*(65535&s)+(s>>16)&r,t=18e3*(65535&t)+(t>>16)&r;let e=(s<<16)+t&r;return e/=4294967296,e+=.5,e*(Math.random()>.5?1:-1)}};for(let r,i=0;i<e;i+=4){const e=s(4294967296*(r||Math.random()));r=987654071*e(),t.push(4294967296*e()|0)}return new n(t,e)}toString(e=o){return e.stringify(this)}concat(e){const t=this.words,s=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(let e=0;e<i;e+=1){const i=s[e>>>2]>>>24-e%4*8&255;t[r+e>>>2]|=i<<24-(r+e)%4*8}else for(let e=0;e<i;e+=4)t[r+e>>>2]=s[e>>>2];return this.sigBytes+=i,this}clamp(){const{words:e,sigBytes:t}=this;e[t>>>2]&=4294967295<<32-t%4*8,e.length=Math.ceil(t/4)}clone(){const e=super.clone.call(this);return e.words=this.words.slice(0),e}}const o={stringify(e){const{words:t,sigBytes:s}=e,r=[];for(let e=0;e<s;e+=1){const s=t[e>>>2]>>>24-e%4*8&255;r.push((s>>>4).toString(16)),r.push((15&s).toString(16))}return r.join("")},parse(e){const t=e.length,s=[];for(let r=0;r<t;r+=2)s[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new n(s,t/2)}},a={stringify(e){const{words:t,sigBytes:s}=e,r=[];for(let e=0;e<s;e+=1){const s=t[e>>>2]>>>24-e%4*8&255;r.push(String.fromCharCode(s))}return r.join("")},parse(e){const t=e.length,s=[];for(let r=0;r<t;r+=1)s[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new n(s,t)}},c={stringify(e){try{return decodeURIComponent(escape(a.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:e=>a.parse(unescape(encodeURIComponent(e)))};class l extends i{constructor(){super(),this._minBufferSize=0}reset(){this._data=new n,this._nDataBytes=0}_append(e){let t=e;"string"==typeof t&&(t=c.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes}_process(e){let t;const{_data:s,blockSize:r}=this,i=s.words,o=s.sigBytes;let a=o/(4*r);a=e?Math.ceil(a):Math.max((0|a)-this._minBufferSize,0);const c=a*r,l=Math.min(4*c,o);if(c){for(let e=0;e<c;e+=r)this._doProcessBlock(i,e);t=i.splice(0,c),s.sigBytes-=l}return new n(t,l)}clone(){const e=super.clone.call(this);return e._data=this._data.clone(),e}}class d extends l{constructor(e){super(),this.blockSize=16,this.cfg=Object.assign(new i,e),this.reset()}static _createHelper(e){return(t,s)=>new e(s).finalize(t)}static _createHmacHelper(e){return(t,s)=>new u(e,s).finalize(t)}reset(){super.reset.call(this),this._doReset()}update(e){return this._append(e),this._process(),this}finalize(e){return e&&this._append(e),this._doFinalize()}}class u extends i{constructor(e,t){super();const s=new e;this._hasher=s;let r=t;"string"==typeof r&&(r=c.parse(r));const i=s.blockSize,n=4*i;r.sigBytes>n&&(r=s.finalize(t)),r.clamp();const o=r.clone();this._oKey=o;const a=r.clone();this._iKey=a;const l=o.words,d=a.words;for(let e=0;e<i;e+=1)l[e]^=1549556828,d[e]^=909522486;o.sigBytes=n,a.sigBytes=n,this.reset()}reset(){const e=this._hasher;e.reset(),e.update(this._iKey)}update(e){return this._hasher.update(e),this}finalize(e){const t=this._hasher,s=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(s))}}const h={stringify(e){const{words:t,sigBytes:s}=e,r=this._map;e.clamp();const i=[];for(let e=0;e<s;e+=3){const n=(t[e>>>2]>>>24-e%4*8&255)<<16|(t[e+1>>>2]>>>24-(e+1)%4*8&255)<<8|t[e+2>>>2]>>>24-(e+2)%4*8&255;for(let t=0;t<4&&e+.75*t<s;t+=1)i.push(r.charAt(n>>>6*(3-t)&63))}const n=r.charAt(64);if(n)for(;i.length%4;)i.push(n);return i.join("")},parse(e){let t=e.length;const s=this._map;let r=this._reverseMap;if(!r){this._reverseMap=[],r=this._reverseMap;for(let e=0;e<s.length;e+=1)r[s.charCodeAt(e)]=e}const i=s.charAt(64);if(i){const s=e.indexOf(i);-1!==s&&(t=s)}return((e,t,s)=>{const r=[];let i=0;for(let n=0;n<t;n+=1)if(n%4){const t=s[e.charCodeAt(n-1)]<<n%4*2|s[e.charCodeAt(n)]>>>6-n%4*2;r[i>>>2]|=t<<24-i%4*8,i+=1}return n.create(r,i)})(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},y=[];for(let e=0;e<64;e+=1)y[e]=4294967296*Math.abs(Math.sin(e+1))|0;const p=(e,t,s,r,i,n,o)=>{const a=e+(t&s|~t&r)+i+o;return(a<<n|a>>>32-n)+t},f=(e,t,s,r,i,n,o)=>{const a=e+(t&r|s&~r)+i+o;return(a<<n|a>>>32-n)+t},g=(e,t,s,r,i,n,o)=>{const a=e+(t^s^r)+i+o;return(a<<n|a>>>32-n)+t},m=(e,t,s,r,i,n,o)=>{const a=e+(s^(t|~r))+i+o;return(a<<n|a>>>32-n)+t};class w extends d{_doReset(){this._hash=new n([1732584193,4023233417,2562383102,271733878])}_doProcessBlock(e,t){const s=e;for(let r=0;r<16;r+=1){const i=t+r,n=e[i];s[i]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8)}const r=this._hash.words,i=s[t+0],n=s[t+1],o=s[t+2],a=s[t+3],c=s[t+4],l=s[t+5],d=s[t+6],u=s[t+7],h=s[t+8],w=s[t+9],b=s[t+10],_=s[t+11],B=s[t+12],S=s[t+13],A=s[t+14],T=s[t+15];let k=r[0],F=r[1],v=r[2],D=r[3];k=p(k,F,v,D,i,7,y[0]),D=p(D,k,F,v,n,12,y[1]),v=p(v,D,k,F,o,17,y[2]),F=p(F,v,D,k,a,22,y[3]),k=p(k,F,v,D,c,7,y[4]),D=p(D,k,F,v,l,12,y[5]),v=p(v,D,k,F,d,17,y[6]),F=p(F,v,D,k,u,22,y[7]),k=p(k,F,v,D,h,7,y[8]),D=p(D,k,F,v,w,12,y[9]),v=p(v,D,k,F,b,17,y[10]),F=p(F,v,D,k,_,22,y[11]),k=p(k,F,v,D,B,7,y[12]),D=p(D,k,F,v,S,12,y[13]),v=p(v,D,k,F,A,17,y[14]),F=p(F,v,D,k,T,22,y[15]),k=f(k,F,v,D,n,5,y[16]),D=f(D,k,F,v,d,9,y[17]),v=f(v,D,k,F,_,14,y[18]),F=f(F,v,D,k,i,20,y[19]),k=f(k,F,v,D,l,5,y[20]),D=f(D,k,F,v,b,9,y[21]),v=f(v,D,k,F,T,14,y[22]),F=f(F,v,D,k,c,20,y[23]),k=f(k,F,v,D,w,5,y[24]),D=f(D,k,F,v,A,9,y[25]),v=f(v,D,k,F,a,14,y[26]),F=f(F,v,D,k,h,20,y[27]),k=f(k,F,v,D,S,5,y[28]),D=f(D,k,F,v,o,9,y[29]),v=f(v,D,k,F,u,14,y[30]),F=f(F,v,D,k,B,20,y[31]),k=g(k,F,v,D,l,4,y[32]),D=g(D,k,F,v,h,11,y[33]),v=g(v,D,k,F,_,16,y[34]),F=g(F,v,D,k,A,23,y[35]),k=g(k,F,v,D,n,4,y[36]),D=g(D,k,F,v,c,11,y[37]),v=g(v,D,k,F,u,16,y[38]),F=g(F,v,D,k,b,23,y[39]),k=g(k,F,v,D,S,4,y[40]),D=g(D,k,F,v,i,11,y[41]),v=g(v,D,k,F,a,16,y[42]),F=g(F,v,D,k,d,23,y[43]),k=g(k,F,v,D,w,4,y[44]),D=g(D,k,F,v,B,11,y[45]),v=g(v,D,k,F,T,16,y[46]),F=g(F,v,D,k,o,23,y[47]),k=m(k,F,v,D,i,6,y[48]),D=m(D,k,F,v,u,10,y[49]),v=m(v,D,k,F,A,15,y[50]),F=m(F,v,D,k,l,21,y[51]),k=m(k,F,v,D,B,6,y[52]),D=m(D,k,F,v,a,10,y[53]),v=m(v,D,k,F,b,15,y[54]),F=m(F,v,D,k,n,21,y[55]),k=m(k,F,v,D,h,6,y[56]),D=m(D,k,F,v,T,10,y[57]),v=m(v,D,k,F,d,15,y[58]),F=m(F,v,D,k,S,21,y[59]),k=m(k,F,v,D,c,6,y[60]),D=m(D,k,F,v,_,10,y[61]),v=m(v,D,k,F,o,15,y[62]),F=m(F,v,D,k,w,21,y[63]),r[0]=r[0]+k|0,r[1]=r[1]+F|0,r[2]=r[2]+v|0,r[3]=r[3]+D|0}_doFinalize(){const e=this._data,t=e.words,s=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32;const i=Math.floor(s/4294967296),n=s;t[15+(r+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),t[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();const o=this._hash,a=o.words;for(let e=0;e<4;e+=1){const t=a[e];a[e]=16711935&(t<<8|t>>>24)|4278255360&(t<<24|t>>>8)}return o}clone(){const e=super.clone.call(this);return e._hash=this._hash.clone(),e}}d._createHelper(w),d._createHmacHelper(w);class b extends i{constructor(e){super(),this.cfg=Object.assign(new i,{keySize:4,hasher:w,iterations:1},e)}compute(e,t){let s;const{cfg:r}=this,i=r.hasher.create(),o=n.create(),a=o.words,{keySize:c,iterations:l}=r;for(;a.length<c;){s&&i.update(s),s=i.update(e).finalize(t),i.reset();for(let e=1;e<l;e+=1)s=i.finalize(s),i.reset();o.concat(s)}return o.sigBytes=4*c,o}}class _ extends l{constructor(e,t,s){super(),this.cfg=Object.assign(new i,s),this._xformMode=e,this._key=t,this.reset()}static createEncryptor(e,t){return this.create(this._ENC_XFORM_MODE,e,t)}static createDecryptor(e,t){return this.create(this._DEC_XFORM_MODE,e,t)}static _createHelper(e){const t=e=>"string"==typeof e?R:D;return{encrypt:(s,r,i)=>t(r).encrypt(e,s,r,i),decrypt:(s,r,i)=>t(r).decrypt(e,s,r,i)}}reset(){super.reset.call(this),this._doReset()}process(e){return this._append(e),this._process()}finalize(e){return e&&this._append(e),this._doFinalize()}}_._ENC_XFORM_MODE=1,_._DEC_XFORM_MODE=2,_.keySize=4,_.ivSize=4;class B extends i{constructor(e,t){super(),this._cipher=e,this._iv=t}static createEncryptor(e,t){return this.Encryptor.create(e,t)}static createDecryptor(e,t){return this.Decryptor.create(e,t)}}function S(e,t,s){const r=e;let i;const n=this._iv;n?(i=n,this._iv=void 0):i=this._prevBlock;for(let e=0;e<s;e+=1)r[t+e]^=i[e]}class A extends B{}A.Encryptor=class extends A{processBlock(e,t){const s=this._cipher,{blockSize:r}=s;S.call(this,e,t,r),s.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}},A.Decryptor=class extends A{processBlock(e,t){const s=this._cipher,{blockSize:r}=s,i=e.slice(t,t+r);s.decryptBlock(e,t),S.call(this,e,t,r),this._prevBlock=i}};const T={pad(e,t){const s=4*t,r=s-e.sigBytes%s,i=r<<24|r<<16|r<<8|r,o=[];for(let e=0;e<r;e+=4)o.push(i);const a=n.create(o,r);e.concat(a)},unpad(e){const t=e,s=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=s}};class k extends _{constructor(e,t,s){super(e,t,Object.assign({mode:A,padding:T},s)),this.blockSize=4}reset(){let e;super.reset.call(this);const{cfg:t}=this,{iv:s,mode:r}=t;this._xformMode===this.constructor._ENC_XFORM_MODE?e=r.createEncryptor:(e=r.createDecryptor,this._minBufferSize=1),this._mode=e.call(r,this,s&&s.words),this._mode.__creator=e}_doProcessBlock(e,t){this._mode.processBlock(e,t)}_doFinalize(){let e;const{padding:t}=this.cfg;return this._xformMode===this.constructor._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e}}class F extends i{constructor(e){super(),this.mixIn(e)}toString(e){return(e||this.formatter).stringify(this)}}const v={stringify(e){let t;const{ciphertext:s,salt:r}=e;return t=r?n.create([1398893684,1701076831]).concat(r).concat(s):s,t.toString(h)},parse(e){let t;const s=h.parse(e),r=s.words;return 1398893684===r[0]&&1701076831===r[1]&&(t=n.create(r.slice(2,4)),r.splice(0,4),s.sigBytes-=16),F.create({ciphertext:s,salt:t})}};class D extends i{static encrypt(e,t,s,r){const n=Object.assign(new i,this.cfg,r),o=e.createEncryptor(s,n),a=o.finalize(t),c=o.cfg;return F.create({ciphertext:a,key:s,iv:c.iv,algorithm:e,mode:c.mode,padding:c.padding,blockSize:o.blockSize,formatter:n.format})}static decrypt(e,t,s,r){let n=t;const o=Object.assign(new i,this.cfg,r);return n=this._parse(n,o.format),e.createDecryptor(s,o).finalize(n.ciphertext)}static _parse(e,t){return"string"==typeof e?t.parse(e,this):e}}D.cfg=Object.assign(new i,{format:v});const E={execute(e,t,s,r){let i=r;i||(i=n.random(8));const o=b.create({keySize:t+s}).compute(e,i),a=n.create(o.words.slice(t),4*s);return o.sigBytes=4*t,F.create({key:o,iv:a,salt:i})}};class R extends D{static encrypt(e,t,s,r){const n=Object.assign(new i,this.cfg,r),o=n.kdf.execute(s,e.keySize,e.ivSize);n.iv=o.iv;const a=D.encrypt.call(this,e,t,o.key,n);return a.mixIn(o),a}static decrypt(e,t,s,r){let n=t;const o=Object.assign(new i,this.cfg,r);n=this._parse(n,o.format);const a=o.kdf.execute(s,e.keySize,e.ivSize,n.salt);return o.iv=a.iv,D.decrypt.call(this,e,n,a.key,o)}}R.cfg=Object.assign(D.cfg,{kdf:E});const U=[],M=[],x=[],I=[],P=[],z=[],O=[],C=[],N=[],q=[],K=[];for(let e=0;e<256;e+=1)K[e]=e<128?e<<1:e<<1^283;let j=0,L=0;for(let e=0;e<256;e+=1){let e=L^L<<1^L<<2^L<<3^L<<4;e=e>>>8^255&e^99,U[j]=e,M[e]=j;const t=K[j],s=K[t],r=K[s];let i=257*K[e]^16843008*e;x[j]=i<<24|i>>>8,I[j]=i<<16|i>>>16,P[j]=i<<8|i>>>24,z[j]=i,i=16843009*r^65537*s^257*t^16843008*j,O[e]=i<<24|i>>>8,C[e]=i<<16|i>>>16,N[e]=i<<8|i>>>24,q[e]=i,j?(j=t^K[K[K[r^t]]],L^=K[K[L]]):(L=1,j=L)}const H=[0,1,2,4,8,16,32,64,128,27,54];class G extends k{_doReset(){let e;if(this._nRounds&&this._keyPriorReset===this._key)return;this._keyPriorReset=this._key;const t=this._keyPriorReset,s=t.words,r=t.sigBytes/4;this._nRounds=r+6;const i=4*(this._nRounds+1);this._keySchedule=[];const n=this._keySchedule;for(let t=0;t<i;t+=1)t<r?n[t]=s[t]:(e=n[t-1],t%r?r>6&&t%r==4&&(e=U[e>>>24]<<24|U[e>>>16&255]<<16|U[e>>>8&255]<<8|U[255&e]):(e=e<<8|e>>>24,e=U[e>>>24]<<24|U[e>>>16&255]<<16|U[e>>>8&255]<<8|U[255&e],e^=H[t/r|0]<<24),n[t]=n[t-r]^e);this._invKeySchedule=[];const o=this._invKeySchedule;for(let t=0;t<i;t+=1){const s=i-t;e=t%4?n[s]:n[s-4],o[t]=t<4||s<=4?e:O[U[e>>>24]]^C[U[e>>>16&255]]^N[U[e>>>8&255]]^q[U[255&e]]}}encryptBlock(e,t){this._doCryptBlock(e,t,this._keySchedule,x,I,P,z,U)}decryptBlock(e,t){const s=e;let r=s[t+1];s[t+1]=s[t+3],s[t+3]=r,this._doCryptBlock(s,t,this._invKeySchedule,O,C,N,q,M),r=s[t+1],s[t+1]=s[t+3],s[t+3]=r}_doCryptBlock(e,t,s,r,i,n,o,a){const c=e,l=this._nRounds;let d=c[t]^s[0],u=c[t+1]^s[1],h=c[t+2]^s[2],y=c[t+3]^s[3],p=4;for(let e=1;e<l;e+=1){const e=r[d>>>24]^i[u>>>16&255]^n[h>>>8&255]^o[255&y]^s[p];p+=1;const t=r[u>>>24]^i[h>>>16&255]^n[y>>>8&255]^o[255&d]^s[p];p+=1;const a=r[h>>>24]^i[y>>>16&255]^n[d>>>8&255]^o[255&u]^s[p];p+=1;const c=r[y>>>24]^i[d>>>16&255]^n[u>>>8&255]^o[255&h]^s[p];p+=1,d=e,u=t,h=a,y=c}const f=(a[d>>>24]<<24|a[u>>>16&255]<<16|a[h>>>8&255]<<8|a[255&y])^s[p];p+=1;const g=(a[u>>>24]<<24|a[h>>>16&255]<<16|a[y>>>8&255]<<8|a[255&d])^s[p];p+=1;const m=(a[h>>>24]<<24|a[y>>>16&255]<<16|a[d>>>8&255]<<8|a[255&u])^s[p];p+=1;const w=(a[y>>>24]<<24|a[d>>>16&255]<<16|a[u>>>8&255]<<8|a[255&h])^s[p];p+=1,c[t]=f,c[t+1]=g,c[t+2]=m,c[t+3]=w}}G.keySize=8;const V={AES:k._createHelper(G),lib:{WordArray:n},mode:{CBC:A},pad:{NoPadding:{pad(){},unpad(){}},ZeroPadding:{pad(e,t){const s=e,r=4*t;s.clamp(),s.sigBytes+=r-(e.sigBytes%r||r)},unpad(e){const t=e,s=t.words;for(let e=t.sigBytes-1;e>=0;e-=1)if(s[e>>>2]>>>24-e%4*8&255){t.sigBytes=e+1;break}}}},enc:{Hex:o}};class X{static base64ToBinaryString(e){try{return atob(e)}catch(t){throw console.error("Incorrect Base64:",e),t}}static binaryStringToBase64(e){return btoa(e)}static arrayBufferToUtf8String(e){return(new TextDecoder).decode(e)}static arrayBufferToBinaryString(e){return e.reduce((e,t)=>e+String.fromCharCode(t),"")}static binaryStringToArrayBuffer(e){const t=new Uint8Array(e.length);for(let s=0;s<e.length;s++)t[s]=e.charCodeAt(s);return t}static base64ToArrayBuffer(e){const t=X.base64ToBinaryString(e);return X.binaryStringToArrayBuffer(t)}static arrayBufferToBase64(e){const t=X.arrayBufferToBinaryString(e);return X.binaryStringToBase64(t)}static arrayBufferToHexString(e){const t=X.ByteToHexTable.get(),s=new Uint8Array(e.buffer),r=new Array(s.length);for(let e=0;e<s.length;e++)r[e]=t[s[e]];return r.join("")}static ByteToHexTable=class{static get(){const e=X.ByteToHexTable;return e.inited||e.init(),e.byteToHex}static byteToHex=[];static inited=!1;static init=()=>{const e=X.ByteToHexTable;for(let t=0;t<256;t++){const s=t.toString(16).padStart(2,"0");e.byteToHex.push(s)}e.inited=!0}};static arrayBufferToLong(e){if(e.length>8)throw"Length is over size of Long";const t=e.reduce((e,t,s)=>e+t*256**s,0);if(t>Number.MAX_SAFE_INTEGER)throw"Over Number.MAX_SAFE_INTEGER";return t}static secondsToFormattedString(e){const t=new Date(1e3*e);function s(e){return e.toString().padStart(2,"0")}return t.getFullYear()+"."+s(t.getMonth()+1)+"."+s(t.getDate())+" "+s(t.getHours())+":"+s(t.getMinutes())+":"+s(t.getSeconds())}static bytesToSize(e,t=2){if(0===e)return"0 B";t=t<0?0:t;const s=Math.floor(Math.log(e)/Math.log(1024));return Number.parseFloat((e/Math.pow(1024,s)).toFixed(t))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][s]}static sleep(e,t=!1){return e<=0?t?X.nextEventLoopTask():Promise.resolve():new Promise(t=>setTimeout(t,e))}static nextEventLoopTask(){return new Promise(e=>{X.setImmediate(e)})}static addSearchParamsToURL(e,t){Object.entries(t).forEach(([t,s])=>{e.searchParams.append(t,s.toString())})}static async repeatIfErrorAsync(e,t=5,s=5e3){for(let r=0;;r++)try{return r&&console.log("REPEAT"),await e()}catch(e){if(console.error(e,`ERROR! Will be repeated. The try ${r+1} of ${t}.`),!(r<t))throw e;await X.sleep(s)}}static getSafeName(e){return e.includes("/")&&console.log(`Bad filename: "${e}"`),e.replace("/","_")}static compareArrays(e,t){if(e.length===t.length){for(let s=0;s<e.length;s++)if(e[s]!==t[s])return!1;return!0}return!1}static stringToBase64(e,t="default"){if("default"===t){const t=unescape(encodeURIComponent(e));return X.binaryStringToBase64(t)}if("safe"===t){const t=(new TextEncoder).encode(e);return X.arrayBufferToBase64(t)}if("unsafe"===t)return X.binaryStringToBase64(e)}static base64ToString(e,t="default"){if("default"===t){const t=X.base64ToBinaryString(e);return decodeURIComponent(escape(t))}if("safe"===t){const t=X.base64ToArrayBuffer(e);return(new TextDecoder).decode(t)}if("unsafe"===t)return X.base64ToBinaryString(e)}static async*iterateReadableStream(e){const t=e.getReader();for(;;){const{done:e,value:s}=await t.read();if(e)break;yield s}}static setImmediate=globalThis.setImmediate||function(){const{port1:e,port2:t}=new MessageChannel,s=[];return e.onmessage=function(){s.shift()()},function(e){t.postMessage(null),s.push(e)}}();static structuredClone(e){return new Promise(t=>{const{port1:s,port2:r}=new MessageChannel;s.onmessage=function(e){t(e.data)},r.postMessage(e)})}}class W{static decryptAES(e,t,{iv:s,mode:r,padding:i}={}){s=s||new Uint8Array(t.length),r=r||"CBC",i=i||"Pkcs7";const n=function(e){const t=Math.trunc(e.length/4)+(e.length%4?1:0),s=new DataView(e.buffer,e.byteOffset,e.byteLength),r=new Array(t);for(let e=0;e<t;e++)r[e]=s.getInt32(4*e,!1);return V.lib.WordArray.create(r,e.byteLength)},o=n(e),a=n(t),c=n(s);return function(e){const{words:t,sigBytes:s}=e,r=new ArrayBuffer(4*t.length),i=new DataView(r);for(let e=0;e<t.length;e++)i.setInt32(4*e,t[e],!1);return new Uint8Array(r,0,s)}(V.AES.decrypt({ciphertext:o},a,{iv:c,mode:V.mode[r],padding:V.pad[i]}))}}class Z{static parseEncodedNodeAttributes(e,t){const s=Z.megaBase64ToArrayBuffer(e),r=W.decryptAES(s,t,{padding:"ZeroPadding"}),i=X.arrayBufferToUtf8String(r).substring("MEGA".length),{n:n,c:o}=JSON.parse(i);return{name:n,serializedFingerprint:o}}static parseFingerprint(e){const t=Z.megaBase64ToArrayBuffer(e),s=t.subarray(0,16),r=t[16],i=t.subarray(17,17+r);if(r>5)throw"Invalid value: timeBytesLength = "+r;return{modificationDate:X.arrayBufferToLong(i),fileChecksum:s}}static decryptionKeyToParts(e){const t=e.subarray(16,24),s=e.subarray(24,32),r=new Uint8Array(16);for(let t=0;t<16;t++)r[t]=e[t]^e[t+16];return{iv:t,metaMac:s,key:r}}static decryptKey(e,t){const s=new Uint8Array(e.length);for(let r=0;r<e.length;r+=16){const i=e.subarray(r,r+16),n=W.decryptAES(i,t,{padding:"NoPadding"});s.set(n,r)}return s}static megaBase64ToBase64(e){const t=function(e){try{const t=(4-e.length%4)%4;if(3===t)throw{name:"IllegalArgumentException",message:"Wrong Mega Base64 string"};return t}catch(e){return 100}}(e);return(e+"=".repeat(t)).replace(/-/g,"+").replace(/_/g,"/")}static megaBase64ToArrayBuffer(e){const t=Z.megaBase64ToBase64(e);return X.base64ToArrayBuffer(t)}static base64ToMegaBase64(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}static arrayBufferToMegaBase64(e){const t=X.arrayBufferToBinaryString(e),s=X.binaryStringToBase64(t);return Z.base64ToMegaBase64(s)}static megaBase64ToBinaryString(e){const t=Z.megaBase64ToBase64(e);return X.base64ToBinaryString(t)}static bytesToSize(e,t){if(0===e)return"0 B";const s=1024;t||(e>Math.pow(s,3)?t=2:e>Math.pow(s,2)&&(t=1));const r=Math.floor(Math.log(e)/Math.log(s));return(e/Math.pow(s,r)).toFixed(t)+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][r]}}class J{static encryptedName=!1;static apiGateway="https://g.api.mega.co.nz/cs";static grouped=!0;static errorRepeatCount=5;static errorRepeatDelay=5e3;static repeatIfErrorAsync(t,s=J.errorRepeatCount,r=J.errorRepeatDelay){return e.repeatIfErrorAsync(t,s,r)}static ssl=2;static semaphore=new s(16,1e3);static RequestApiGrouped=class extends r{async handle(e){const t=e.key,s=e.pull(),r=[];for(const e of s)r.push(e.getValue());const i=await J.requestApiSafe(t,r);s.forEach((e,t)=>{e.resolve(i[t])})}};static requestApiGrouped=new J.RequestApiGrouped;static async requestApi(t,s={},r=J.grouped){const i=new URL(J.apiGateway);e.addSearchParamsToURL(i,s);const n=i.toString();return r?J.requestApiGrouped.getResult({key:n,value:t}):(await J.requestApiSafe(n,[t]))[0]}static async requestApiSafe(e,t){await J.semaphore.acquire();try{const s=await J.repeatIfErrorAsync(s=>J.requestApiUnsafe(e,t));return J.apiErrorHandler(s)}finally{J.semaphore.release()}}static async requestApiUnsafe(e,t){const s=await fetch(e,{method:"post",body:JSON.stringify(t),referrerPolicy:"strict-origin-when-cross-origin"});if(500===s.status)throw Error("ERR_ABORTED 500 (Server Too Busy)");200!==s.status&&console.error("[response.status]",s.status);const r=await s.text();return JSON.parse(r)}static apiErrorHandler(e){if(Array.isArray(e))return e;throw-9===e?new Error("ERROR CODE: -9. NOT FOUND"):-16===e?new Error("ERROR CODE: -16. USER IS BLOCKED"):-3===e?new Error("ERROR CODE: -3. AGAIN"):new Error("ERROR CODE: "+e)}static async requestFileAttributeDownloadUrl({id:e,type:t}){console.log("Request download url...");return(await J.requestApi({a:"ufa",fah:e,ssl:J.ssl,r:1})).p+"/"+t}static async requestFileAttributeBytes(e,s){let r;if(Array.isArray(s)){r=new Uint8Array(8*s.length);for(let e=0;e<s.length;e++)r.set(t.megaBase64ToArrayBuffer(s[e]),8*e)}else r=t.megaBase64ToArrayBuffer(s);const i=await J.repeatIfErrorAsync(async()=>{console.log("Downloading content... ");const t=await fetch(e,{method:"post",body:r,headers:{connection:"keep-alive"},referrerPolicy:"strict-origin-when-cross-origin"});return 200!==t.status&&console.error("[response.status]",t.status),new Uint8Array(await t.arrayBuffer())});return console.log("[downloaded]",i.length,"bytes"),i}static async requestNodeInfo(e){const t=await J.requestApi({a:"g",p:e,g:1,ssl:J.ssl}),s={size:t.s,nodeAttributesEncoded:t.at,downloadUrl:t.g,timeLeft:t.tl,EFQ:t.efq,MSD:t.msd};return t.fa&&(s.fileAttributesStr=t.fa),s}static async requestFolderInfo(e){const t=await J.requestApi({a:"f",r:1,c:1,ca:1},{n:e}),{f:s,sn:r,noc:i}=t;const n=function(e){const t=e[0],s=t.k.match(/^[^:]+/)[0];return s!==t.h&&console.warn("ShareRootNodeId does not equal to id of the first node."),s}(s);function o(e){switch(e){case 0:return"file";case 1:return"folder";default:return e}}function a(e){const t=e.k;return""===t?(console.log("A missed key!",e),null):t.match(/(?<=:)[\w-_]+/)[0]}return{nodes:function(e){return e.map(e=>{const t={id:e.h,parentId:e.p,ownerId:e.u,type:o(e.t),attributes:e.a,decryptionKeyStr:a(e),creationDate:e.ts};return"file"===t.type&&(t.size=e.s,e.fa&&(t.fileAttributesStr=e.fa)),t})}(s),rootId:n}}}class Y{key;first;constructor(e,t,s){this.key=e,this.first=t,this.groupedTasks=s}pull(){return this.groupedTasks.pullEntries(this.key)}parts(e){return this.groupedTasks.pullParts(this.key,e)}}class ${constructor({entryClass:e,delayStrategy:t}={}){this.entryClass=e||$.SimpleEntry,this.delayStrategy=t||$.execute.afterDelayWithMicroTask}static SimpleEntry=class{resolve;constructor(e,t,s,r){this.key=e,this.value=t,this.resolve=s,this.reject=r}getKey(){return this.key}getValue(){return this.value}needHandle(){return!0}getResult(){throw"SimpleEntry.getResult() method does not implemented"}};queue=new Map;getResult({key:e,value:t}){return new Promise((s,r)=>{const i=new this.entryClass(e,t,s,r);i.needHandle()?this.enqueue(i):s(i.getResult())})}enqueue(e){const t=e.getKey();this.queue.has(t)||(this.queue.set(t,[]),this.delayStrategy(()=>{this.handle(new Y(t,e,this)).catch(e.reject)})),this.queue.get(t).push(e)}pullEntries(e){const t=this.queue.get(e);return this.queue.delete(e),t}*pullParts(e,t){const s=this.pullEntries(e);if(t){let e=0;for(;e<s.length;)yield s.slice(e,e+t),e+=t}else yield s}async handle(e){}static execute=class{static now(e){e()}static afterDelayWithMicroTask(e){Promise.resolve().then(e)}static afterDelayWithEventLoop(e){setImmediate?setImmediate(e):setTimeout(e,0)}static afterDelay(e,t=0){setTimeout(e,t)}}}class Q{constructor(e=1,t=0){this.limit=e,this.delay=t}active=0;pending=[];completeTimes=[];async acquire(){if(this.isDisabled)return;const e=this.completeTimes.length;if(e>0&&e===this.limit-this.active){const t=this.delay-(performance.now()-this.completeTimes.shift());console.log("completed: "+e+", active: "+this.active+", wait: "+t),await X.sleep(t)}if(!(this.active<this.limit))return new Promise(e=>{this.pending.push(e)});this.active++}release(){this._release().then()}async _release(){if(!this.isDisabled)if(this.active>0)if(this.active--,this.pending.length>0){const e=this.pending.shift();this.active++,await X.sleep(this.delay),e()}else this.delay>0&&this.completeTimes.push(performance.now());else console.warn("[Semaphore] over released")}async sync(e){try{return await this.acquire(),await e()}finally{this.release()}}releaseAll(){for(;this.pending.length;){this.pending.shift()()}this.active=0,this.completeTimes=[]}_limit;_delay;set limit(e){this._limit=e<1?1:e}get limit(){return this._limit}set delay(e){this._delay=e<0?0:e}get delay(){return this._delay}isDisabled=!1;disable(e=!0){e&&this.releaseAll(),this.isDisabled=!0}enable(){this.isDisabled=!1}static disabled(e=1,t=0){const s=new Q(e,t);return s.disable(),s}}class ee{_count;_promise;_resolve;constructor(e=0){this._count=e,this._promise=e>0?new Promise(e=>{this._resolve=e}):Promise.resolve()}countDown(){this._count>0&&(this._count--,0===this._count&&this._resolve())}wait(){return this._promise}get released(){return this._count>0}release(){this._count=0,this._resolve()}}class te extends ee{countUp(){0===this._count&&(this._promise=new Promise(e=>{this._resolve=e})),this._count++}}var se={Semaphore:Q,CountDownLatch:ee,CountUpAndDownLatch:te},re=Object.freeze({__proto__:null,Semaphore:Q,CountDownLatch:ee,CountUpAndDownLatch:te,default:se});class ie{id;type;bunch;constructor(e,t,s){this.id=e,this.type=Number(t),this.bunch=ne.of(Number(s))}getDownloadUrl(e=!0){return oe.hasBytes(this)?this.bunch.getDownloadUrl(this,e):null}toString(){return this.bunch+":"+this.type+"*"+this.id}}class ne{id;downloadUrl=null;static values=new Map;constructor(e){this.id=Number(e)}toString(){return this.id.toString()}static of(e){if(ne.values.has(e))return ne.values.get(e);const t=new ne(e);return ne.values.set(e,t),t}async getDownloadUrl(e,t=!0){if(t&&this.hasDownloadUrl)return this.downloadUrl;const s=await J.requestFileAttributeDownloadUrl(e);return this.downloadUrl=s,s}get hasDownloadUrl(){return Boolean(this.downloadUrl)}get downloadUrl(){return this.downloadUrl}}class oe{static thumbnail=0;static preview=1;static hasBytes(e){return e.type===oe.preview||e.type===oe.thumbnail}}class ae{static cached=!0;static grouped=!0;type;get type(){return this.type}constructor(e){this.type=e}static DlUrlRequests=class extends ${async handle(e){const t=e.first.getValue(),s=await t.getDownloadUrl();for(const t of e.pull())t.resolve(s)}static RequestDlUrlEntry=class extends $.SimpleEntry{needHandle(){return!this.getValue().bunch.hasDownloadUrl}getResult(){return this.getValue().bunch.downloadUrl}getKey(){return this.getValue().bunch.id}}};static dlUrlRequests=new ae.DlUrlRequests({entryClass:ae.DlUrlRequests.RequestDlUrlEntry,delayStrategy:$.execute.now});getDownloadUrl({fileAttribute:e,node:t},s=ae.cached){const r=e||ce.of(t).byType(this.type);return s?ae.dlUrlRequests.getResult({value:r}):r.getDownloadUrl(!1)}static DlBytesRequests=class extends ${async handle(e){const t=e.key,s=new Q(16);for(const r of e.parts(16))s.sync(()=>this.handlePart(t,r)).then()}async handlePart(e,t){const s=new Map;for(const e of t){const t=e.getValue();s.has(t)||s.set(t,[]),s.get(t).push(e.resolve)}const r=[...s.keys()],i=ae.fileAttributeBytes(e,r);for await(const{id:e,dataBytes:t}of i){const r=s.get(e);for(const e of r)e(t)}}};static dlBytesRequests=new ae.DlBytesRequests;async getEncryptedBytes({fileAttribute:e,downloadUrl:t,node:s},r=ae.grouped){const i=e||ce.of(s).byType(this.type),n=t||await this.getDownloadUrl({fileAttribute:i});if(r)return ae.dlBytesRequests.getResult({key:n,value:i.id});const o=await J.requestFileAttributeBytes(n,i.id);return ae.parseBytes(o).dataBytes}static async*fileAttributeBytes(e,t){const s=await J.requestFileAttributeBytes(e,t);for(let e=0,r=0;e<t.length;e++){const{id:e,dataBytes:t}=ae.parseBytes(s,r);yield{id:e,dataBytes:t},r+=12+t.length}}static parseBytes(e,t=0){const s=e.subarray(t,t+8),r=e.subarray(t+8,t+12),i=X.arrayBufferToLong(r),n=e.subarray(t+12,t+12+i);return{id:Z.arrayBufferToMegaBase64(s),dataBytes:n}}async getBytes({fileAttributes:e,encryptedBytes:t,node:s,downloadUrl:r}){const i=e||ce.of(s),n=i.byType(this.type),o=t||await this.getEncryptedBytes({fileAttribute:n,downloadUrl:r,node:s});if(!i.nodeKey){if(ce.strictMode)throw"No key specified for the file attribute decryption.";return console.log("No key specified for the file attribute decryption. Skipping the decryption."),o}return console.log("Decryption of a file attribute..."),W.decryptAES(o,i.nodeKey,{padding:"ZeroPadding"})}}class ce{static strictMode=!1;fileAttributes;nodeKey;constructor(e){const t=[];e.fileAttributesStr.split("/").forEach(e=>{const s=e.match(/(?<bunch>\d+):(?<type>\d+)\*(?<id>.+)/).groups,{id:r,type:i,bunch:n}=s;t.push(new ie(r,i,n))}),this.fileAttributes=t,this.nodeKey=e.key||null}toString(){return this.fileAttributes.join("/")}byType(e){return this.fileAttributes.find(t=>t.type===e)}static values=new Map;static add(e){ce.values.get(e.fileAttributesStr)||ce.values.set(e.fileAttributesStr,new ce(e))}static get(e){return ce.values.get(e.fileAttributesStr)}static of(e){return ce.add(e),ce.get(e)}static Thumbnail=new ae(oe.thumbnail);static Preview=new ae(oe.preview);static getThumbnail(e){return ce.getAttribute(e,ce.Thumbnail)}static getPreview(e){return ce.getAttribute(e,ce.Preview)}static getAttribute(e,t){return t.getBytes({node:e})}}class le{id;decryptionKeyStr;isFolder;selectedFolderId;selectedFileId;constructor(e){Object.assign(this,e)}toString(){return"[id]               "+this.id+"\n[decryptionKeyStr] "+this.decryptionKeyStr+"\n[isFolder]         "+this.isFolder+"\n[selectedFolderId] "+this.selectedFolderId+"\n[selectedFileId]   "+this.selectedFileId+"\n[url]              "+this.getUrl()+"\n[url-legacy]       "+this.getUrl(!0)}static isFolder(e){return le.fromUrl(e).isFolder}get selectedId(){return this.selectedFileId||this.selectedFolderId||null}static fromUrl(e){const t=e.toString();let s;s=t.match(/#F!|#!/)?/(?<type>(?<isFolder>#F!)|(?<isFile>#!))(?<id>[\w-_]+)(?<keyPrefix>!(?=[\w-_]{22,43})|!(?=[!?])|!(?![\w-_]{8}))?(?<key>(?<=!)[\w-_]{22,43})?(?<selected>((?<selectedFilePrefix>\?)|(?<selectedFolderPrefix>!?))((?<file>(?<=\?)[\w-_]+)|(?<folder>(?<=!)[\w-_]+)))?/:/(?<type>(?<isFolder>folder\/)|(?<isFile>file\/))(?<id>[\w-_]+)(?<keyPrefix>#)?(?<key>(?<=#)[\w-_]{22,43})?(?<selected>((?<selectedFilePrefix>\/file\/)|(?<selectedFolderPrefix>\/folder\/))((?<file>(?<=\/file\/)[\w-_]+)|(?<folder>(?<=\/folder\/)[\w-_]+)))?/;const r=t.match(s);if(!r)throw`Unsupported URL ("${t}")`;const{groups:i}=r,n=Boolean(i.isFolder),o=i.id,a=i.key||"",c=i.folder||"",l=i.file||"";return new le({id:o,decryptionKeyStr:a,isFolder:n,selectedFolderId:c,selectedFileId:l})}static fromParts({id:e,decryptionKeyStr:t="",isFolder:s=!1,selectedFolderId:r="",selectedFileId:i=""}){return new le({id:e,decryptionKeyStr:t,isFolder:s,selectedFolderId:r,selectedFileId:i})}getUrl(e=!1){let t;const s=e?"#F":"folder",r=e?"#":"file",i=e?"!":"/",n=e?"!":"#",o=e?"?":"/file/",a=e?"!":"/folder/";let c="";return this.selectedFileId?c=o+this.selectedFileId:this.selectedFolderId&&(c=a+this.selectedFolderId),t="https://mega.nz/"+(this.isFolder?s:r)+i+this.id+(this.decryptionKeyStr?n+this.decryptionKeyStr:"")+(c&&!this.decryptionKeyStr?n+c:c),t}}class de{[Symbol.toStringTag]="BasicFolderShareNode";constructor(e,t){if(this.id=e.id,this.parentId=e.parentId,this.parent=e.parent||null,this.ownerId=e.ownerId,this.creationDate=e.creationDate,t&&e.decryptionKeyStr){const s=Z.megaBase64ToArrayBuffer(e.decryptionKeyStr);this._decryptionKey=Z.decryptKey(s,t)}else this._decryptionKey=null}type;id;parentId;parent;ownerId;creationDate;_decryptionKey;get key(){return this._decryptionKey}name;get path(){return this.parent?[...this.parent.path,this.parent.name]:[]}get root(){return"rootFolder"===this.parent.type?this.parent:this.parent.root}}class ue extends de{[Symbol.toStringTag]="FileNode";constructor(e,t){if(super(e,t),this.type="file",this.size=e.size,t&&e.decryptionKeyStr){const{name:t,serializedFingerprint:s}=Z.parseEncodedNodeAttributes(e.attributes,this.key);this.name=t;const{modificationDate:r,fileChecksum:i}=Z.parseFingerprint(s);this.modificationDate=r}else this.modificationDate=null,this.name=we(e.attributes,!0)}size;_keyParts;get key(){return this._keyParts||(super.key?this._keyParts=Z.decryptionKeyToParts(super.key):this._keyParts={iv:null,metaMac:null,key:null}),this._keyParts.key}modificationDate;get mtime(){return this.modificationDate}get modificationDateFormatted(){return X.secondsToFormattedString(this.modificationDate)}get downloadUrl(){return null}}class he extends ue{[Symbol.toStringTag]="MediaFileNode";constructor(e,t){super(e,t),this.type="mediaFile",this.fileAttributesStr=e.fileAttributesStr}fileAttributesStr;getThumbnail(){return ce.getThumbnail(this)}getPreview(){return ce.getPreview(this)}get thumbnail(){return ce.of(this).byType(ce.Thumbnail.type)}get preview(){return ce.of(this).byType(ce.Preview.type)}}class ye extends de{[Symbol.toStringTag]="FolderNode";constructor(e,t){if(super(e,t),this.type="folder",t){const{name:t}=Z.parseEncodedNodeAttributes(e.attributes,this.key);this.name=t}else this.name=we(e.attributes,!1)}folders=[];files=[];_size=0;get size(){return this._size}}class pe extends ye{get[Symbol.toStringTag](){return"RootFolderNode"}constructor(e,t){super(e,t),this.type="rootFolder"}get root(){return this}}class fe{[Symbol.toStringTag]="SharedFileNode";constructor(e,t){if(this.type="sharedFile",this.id=e.id,e.decryptionKeyStr){const t=Z.megaBase64ToArrayBuffer(e.decryptionKeyStr),{iv:s,metaMac:r,key:i}=Z.decryptionKeyToParts(t);this.key=i}else this.key=null;const{size:s,nodeAttributesEncoded:r,downloadUrl:i,timeLeft:n}=t;if(this.size=s,this._meta={downloadUrl:i,timeLeft:n},e.decryptionKeyStr){const{name:e,serializedFingerprint:t}=Z.parseEncodedNodeAttributes(r,this.key),{modificationDate:s,fileChecksum:i}=t?Z.parseFingerprint(t):{};this.name=e,this.modificationDate=s}else this.modificationDate=null,this.name=we(r,!1)}type;id;size;key;name;modificationDate;get mtime(){return this.modificationDate}get modificationDateFormatted(){return X.secondsToFormattedString(this.modificationDate)}_meta;get timeLeft(){return this._meta.timeLeft}get downloadUrl(){return this._meta.downloadUrl}}class ge extends fe{[Symbol.toStringTag]="SharedMediaFileNode";constructor(e,t){super(e,t),this.type="sharedMediaFile",this.fileAttributesStr=t.fileAttributesStr}fileAttributesStr;getThumbnail(){return ce.getThumbnail(this)}getPreview(){return ce.getPreview(this)}}class me{static async of(e){const t=le.fromUrl(e);return t.isFolder?me.getFolderNodes(t):me.getSharedNode(t)}static async node(e){const t=le.fromUrl(e);if(t.isFolder){const e=await me.getFolderNodes(t);return e.selected?e.selected:e.root}return me.getSharedNode(t)}static async nodes(e){const t=le.fromUrl(e);return t.isFolder?me.getFolderNodes(t):[await me.getSharedNode(t)]}static async getSharedNode(e){const t=await J.requestNodeInfo(e.id);return t.fileAttributesStr?new ge(e,t):new fe(e,t)}static async getFolderNodes(e){const t=e.decryptionKeyStr?Z.megaBase64ToArrayBuffer(e.decryptionKeyStr):null,{nodes:s,rootId:r}=await J.requestFolderInfo(e.id),i=new Map,n=[];for(let e=0;e<s.length;e++){const o=s[e];let a;o.parent=i.get(o.parentId),"file"===o.type?(a=o.fileAttributesStr?new he(o,t):new ue(o,t),n.push(a),i.get(a.parentId).files.push(a)):"folder"===o.type&&(o.id===r?a=new pe(o,t):(a=new ye(o,t),i.get(a.parentId).folders.push(a)),i.set(o.id,a)),s[e]=null}const o=[...i.values(),...n],a=i.get(r),c=o.find(t=>t.id===e.selectedId);return Object.defineProperty(o,"root",{get:()=>a}),Object.defineProperty(o,"selected",{get:()=>c}),Object.defineProperty(o,"folders",{get:()=>[...i.values()]}),Object.defineProperty(o,"files",{get:()=>n}),o}static isMediaNode(e){return"sharedMediaFile"===e.type||"mediaFile"===e.type}}function we(e,t){if(!J.encryptedName)return null;let s=Math.trunc(3*e.length/4)-19;return t&&(s-=28),s-=1,s<0&&(s=16),console.log(s),"█".repeat(s)}const be=me.nodes,_e=me.node;export{ae as FileAttributeBytes,ce as FileAttributes,J as MegaApi,Z as MegaUtil,me as Nodes,le as Share,re as Synchronization,X as Util,_e as node,be as nodes};
//# sourceMappingURL=meganz-api.standalone.es.min.js.map